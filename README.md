# Bayesian Ordinal Probit (Wine Quality) - Gibbs + Metropolis–Hastings in R

This repository implements a Bayesian **ordinal probit** model for the *Vinho Verde* wine quality dataset.
Inference is performed with a custom **Gibbs sampler** (latent variables + regression coefficients) combined with a **Metropolis–Hastings** step for the cutpoints.

## Repository layout

- `analysis/`
  - `01_Intro_and_EDA.Rmd` — introduction + exploratory data analysis
  - `02_Model_fit.Rmd` — model, sampler, diagnostics, posterior summaries, PPC
- `R/`
  - `ordinal_probit_sampler.R` — Gibbs + MH sampler implementation
  - `posterior_predictive.R` — posterior predictive simulation helpers
- `data/`
  - `raw/vino_qualita.csv` — raw dataset
  - `processed/wine_reduced.csv` — processed dataset
  - `README.md` — data notes and source
- `outputs/`
  - `fits/ordinal_probit_mcmc.rds` — saved MCMC output (generated by the analysis)
- `bayesian-linear-probit.Rproj` — RStudio project file
- `LICENSE`

## Data

- Raw data: `data/raw/vino_qualita.csv`
- Processed data: `data/processed/wine_reduced.csv`

See `data/README.md` for dataset source details.

## Requirements

Install the required R packages:

```r
install.packages(c(
  "truncnorm", "MASS",
  "coda", "bayesplot",
  "ggplot2", "rmarkdown"
))
```

## How to run

Open the project with `bayesian-linear-probit.Rproj` (recommended), or set your working directory to the repository root.

Render the Intro + EDA report:

```r
rmarkdown::render("analysis/01_Intro_and_EDA.Rmd")
```

Render the model fitting report (runs MCMC + diagnostics + PPC):

```r
rmarkdown::render("analysis/02_Model_fit.Rmd")
```

## Notes

- Predictors are standardized before fitting.
- Quality scores are restricted to the 3–8 range (and re-indexed internally for the sampler).
- The intercept may mix more slowly than slope coefficients due to confounding with the cutpoints; inference focuses primarily on slope effects and posterior predictive performance.

## License

See `LICENSE`.
